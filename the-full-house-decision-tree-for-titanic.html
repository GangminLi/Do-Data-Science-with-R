<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.3 The Full-house Decision Tree for Titanic | 07-decision-tree.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="1.3 The Full-house Decision Tree for Titanic | 07-decision-tree.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.3 The Full-house Decision Tree for Titanic | 07-decision-tree.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-simplest-decision-tree-for-titanic.html"/>
<link rel="next" href="the-decision-tree-with-re-engineered-dataset.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Authoring Books with R Markdown</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="prediction-with-decision-trees.html"><a href="prediction-with-decision-trees.html"><i class="fa fa-check"></i><b>1</b> Prediction with Decision Trees</a><ul>
<li class="chapter" data-level="1.1" data-path="decision-tree-in-hunts-algorithm.html"><a href="decision-tree-in-hunts-algorithm.html"><i class="fa fa-check"></i><b>1.1</b> Decision tree in Hunt’s Algorithm</a><ul>
<li class="chapter" data-level="1.1.1" data-path="decision-tree-in-hunts-algorithm.html"><a href="decision-tree-in-hunts-algorithm.html#test_condition"><i class="fa fa-check"></i><b>1.1.1</b> How to Form a Test Condition?</a></li>
<li class="chapter" data-level="1.1.2" data-path="decision-tree-in-hunts-algorithm.html"><a href="decision-tree-in-hunts-algorithm.html#best_split"><i class="fa fa-check"></i><b>1.1.2</b> How to Determine the Best Split Condition?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="the-simplest-decision-tree-for-titanic.html"><a href="the-simplest-decision-tree-for-titanic.html"><i class="fa fa-check"></i><b>1.2</b> The Simplest Decision Tree for Titanic</a></li>
<li class="chapter" data-level="1.3" data-path="the-full-house-decision-tree-for-titanic.html"><a href="the-full-house-decision-tree-for-titanic.html"><i class="fa fa-check"></i><b>1.3</b> The Full-house Decision Tree for Titanic</a></li>
<li class="chapter" data-level="1.4" data-path="the-decision-tree-with-re-engineered-dataset.html"><a href="the-decision-tree-with-re-engineered-dataset.html"><i class="fa fa-check"></i><b>1.4</b> The Decision Tree with Re-engineered Dataset</a></li>
<li class="chapter" data-level="1.5" data-path="a-light-decision-tree-with-re-engineered-dataset.html"><a href="a-light-decision-tree-with-re-engineered-dataset.html"><i class="fa fa-check"></i><b>1.5</b> A Light Decision Tree with Re-engineered Dataset</a></li>
<li class="chapter" data-level="1.6" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>1.6</b> Summary</a></li>
<li class="chapter" data-level="1.7" data-path="excerces.html"><a href="excerces.html"><i class="fa fa-check"></i><b>1.7</b> Excerces</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-full-house-decision-tree-for-titanic" class="section level2">
<h2><span class="header-section-number">1.3</span> The Full-house Decision Tree for Titanic</h2>
<p>Let us try another extreme, we use all the original attributes possible without selection or discrimination, which knowing from the <strong>understanding data</strong> that have some prediction power and not too many levels (possibilities).</p>
<p>Among of attributes, we choose <em>Pclass</em>, <em>Sex</em>, <em>Age</em>,,<em>SibSp</em>, <em>Parch</em>, <em>Fare</em>, <em>Cabin</em> and <em>Embarked</em>. We somehow escape <em>Name</em> and <em>Ticket</em>, which we believe that they not really have any power of prediction.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="the-full-house-decision-tree-for-titanic.html#cb24-1"></a><span class="co"># The full-house classifier apart from name and ticket </span></span>
<span id="cb24-2"><a href="the-full-house-decision-tree-for-titanic.html#cb24-2"></a>model2 &lt;-<span class="st"> </span><span class="kw">rpart</span>(Survived <span class="op">~</span><span class="st"> </span>Pclass <span class="op">+</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>SibSp <span class="op">+</span><span class="st"> </span>Parch <span class="op">+</span><span class="st"> </span>Fare <span class="op">+</span><span class="st"> </span>Embarked, <span class="dt">data=</span>train, <span class="dt">method=</span><span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="the-full-house-decision-tree-for-titanic.html#cb25-1"></a><span class="co"># assess the accuracy with train data</span></span>
<span id="cb25-2"><a href="the-full-house-decision-tree-for-titanic.html#cb25-2"></a>Predict_model2_train &lt;-<span class="st"> </span><span class="kw">predict</span>(model2, train, <span class="dt">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb25-3"><a href="the-full-house-decision-tree-for-titanic.html#cb25-3"></a>conMat &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(<span class="kw">as.factor</span>(Predict_model2_train), <span class="kw">as.factor</span>(train<span class="op">$</span>Survived))</span>
<span id="cb25-4"><a href="the-full-house-decision-tree-for-titanic.html#cb25-4"></a>conMat<span class="op">$</span>table</span></code></pre></div>
<pre><code>##           Reference
## Prediction   0   1
##          0 521 115
##          1  28 227</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="the-full-house-decision-tree-for-titanic.html#cb27-1"></a><span class="co">#conMat$overall</span></span>
<span id="cb27-2"><a href="the-full-house-decision-tree-for-titanic.html#cb27-2"></a>predict2_train_accuracy &lt;-<span class="st"> </span>conMat<span class="op">$</span>overall[<span class="st">&quot;Accuracy&quot;</span>]</span>
<span id="cb27-3"><a href="the-full-house-decision-tree-for-titanic.html#cb27-3"></a>predict2_train_accuracy</span></code></pre></div>
<pre><code>##  Accuracy 
## 0.8395062</code></pre>
<p>Our assessment on model2’s accuracy is make a prediction on train data and compare the predicted value with the original value. It shows our model2’s accuracy is 83.95%. This is great! Let us use this model to make a prediction on test dataset.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="the-full-house-decision-tree-for-titanic.html#cb29-1"></a>Prediction2 &lt;-<span class="st"> </span><span class="kw">predict</span>(model2, test, <span class="dt">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb29-2"><a href="the-full-house-decision-tree-for-titanic.html#cb29-2"></a>submit2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">PassengerId =</span> test<span class="op">$</span>PassengerId, <span class="dt">Survived =</span> Prediction2)</span>
<span id="cb29-3"><a href="the-full-house-decision-tree-for-titanic.html#cb29-3"></a><span class="kw">write.csv</span>(submit2, <span class="dt">file =</span> <span class="st">&quot;Tree_model2.CSV&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>We have produced our second prediction. We can also submit our result to Kaggle website for the second evaluation.</p>
<p>This time, we can see the score has been increased to 0.77511. That shows us our prediction on test data has achieved <strong>77.511%</strong> accuracy. Despite it is lower than the accuracy we have achieved with the train data 83.95%, it has improved on the previous 76.555% nearly 1 percent on the test data.</p>
<p>Let us examine our classifier again by plot it in a graph.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="the-full-house-decision-tree-for-titanic.html#cb30-1"></a><span class="co"># plot our full house classifier </span></span>
<span id="cb30-2"><a href="the-full-house-decision-tree-for-titanic.html#cb30-2"></a><span class="kw">prp</span>(model2, <span class="dt">type =</span> <span class="dv">0</span>, <span class="dt">extra =</span> <span class="dv">1</span>, <span class="dt">under =</span> <span class="ot">TRUE</span>)</span>
<span id="cb30-3"><a href="the-full-house-decision-tree-for-titanic.html#cb30-3"></a><span class="co"># plot our full house classifier </span></span>
<span id="cb30-4"><a href="the-full-house-decision-tree-for-titanic.html#cb30-4"></a><span class="kw">fancyRpartPlot</span>(model2)</span></code></pre></div>
<div class="figure"><span id="fig:tree2"></span>
<img src="07-decision-tree_files/figure-html/tree2-1.svg" alt="Decision trees with multiple original predictors." width="50%" /><img src="07-decision-tree_files/figure-html/tree2-2.svg" alt="Decision trees with multiple original predictors." width="50%" />
<p class="caption">
Figure 1.5: Decision trees with multiple original predictors.
</p>
</div>
<p>The above decision tree appeared much complicated than the first one and it goes a lot deeper than what we saw last time. Note that the both trees are binary trees (have two branches). For test conditions that more than two possible answers have been changed to a binary by auto add a split with them. For example, age are numbers and have 10s of possibilities, our model simply split it by a test condition <code>"Age &gt;= 6.5"</code>. Conditions have been automatically set for others attributes as well such as <code>"Pclass &gt;= 2.5"</code>, <code>"SibSp&gt;=2.5"</code>, and <code>"Fare &gt;= 18"</code>, etc.</p>
<p>This conditions are not ideal, they can be changed if you know how to optimize decision tree. For the moment it looks very promising that resonates with the famous naval law that “women and kids first” is visible in our model.</p>
<p>If you want look into the difference between our two predictions, you can do,</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="the-full-house-decision-tree-for-titanic.html#cb31-1"></a><span class="co"># build a comparison data frame to record each prediction results</span></span>
<span id="cb31-2"><a href="the-full-house-decision-tree-for-titanic.html#cb31-2"></a>Tree_compare &lt;-<span class="st"> </span><span class="kw">data.frame</span>(test<span class="op">$</span>PassengerId, <span class="dt">predict1=</span>Prediction1, <span class="dt">predict2=</span>Prediction2)</span>
<span id="cb31-3"><a href="the-full-house-decision-tree-for-titanic.html#cb31-3"></a><span class="co"># Find differences</span></span>
<span id="cb31-4"><a href="the-full-house-decision-tree-for-titanic.html#cb31-4"></a>dif &lt;-<span class="st"> </span>Tree_compare[Tree_compare[<span class="dv">2</span>]<span class="op">!=</span>Tree_compare[<span class="dv">3</span>], ]</span>
<span id="cb31-5"><a href="the-full-house-decision-tree-for-titanic.html#cb31-5"></a><span class="co">#show dif</span></span>
<span id="cb31-6"><a href="the-full-house-decision-tree-for-titanic.html#cb31-6"></a>dif</span></code></pre></div>
<pre><code>##     test.PassengerId predict1 predict2
## 2                893        1        0
## 19               910        1        0
## 33               924        1        0
## 34               925        1        0
## 37               928        1        0
## 38               929        1        0
## 73               964        1        0
## 81               972        0        1
## 88               979        1        0
## 90               981        0        1
## 99               990        1        0
## 133             1024        1        0
## 139             1030        1        0
## 141             1032        1        0
## 158             1049        1        0
## 166             1057        1        0
## 170             1061        1        0
## 189             1080        1        0
## 197             1088        0        1
## 198             1089        1        0
## 200             1091        1        0
## 202             1093        0        1
## 215             1106        1        0
## 269             1160        1        0
## 281             1172        1        0
## 282             1173        0        1
## 285             1176        1        0
## 308             1199        0        1
## 346             1237        1        0
## 355             1246        1        0
## 366             1257        1        0
## 368             1259        1        0
## 377             1268        1        0
## 413             1304        1        0</code></pre>
<p>We can see the second classifier have produced 34 different predictions in comparison with the first classifier. That is a great improvement.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-simplest-decision-tree-for-titanic.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-decision-tree-with-re-engineered-dataset.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown/edit/master/inst/examples/%s",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
