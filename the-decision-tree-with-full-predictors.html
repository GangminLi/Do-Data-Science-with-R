<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.5 The Decision Tree with Full Predictors | 07-decision-tree.utf8</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="1.5 The Decision Tree with Full Predictors | 07-decision-tree.utf8" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.5 The Decision Tree with Full Predictors | 07-decision-tree.utf8" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-decision-tree-with-more-predictors.html"/>
<link rel="next" href="summary.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Authoring Books with R Markdown</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="prediction-with-decision-trees.html"><a href="prediction-with-decision-trees.html"><i class="fa fa-check"></i><b>1</b> Prediction with Decision Trees</a><ul>
<li class="chapter" data-level="1.1" data-path="decision-tree-in-hunts-algorithm.html"><a href="decision-tree-in-hunts-algorithm.html"><i class="fa fa-check"></i><b>1.1</b> Decision tree in Hunt’s Algorithm</a><ul>
<li class="chapter" data-level="1.1.1" data-path="decision-tree-in-hunts-algorithm.html"><a href="decision-tree-in-hunts-algorithm.html#test_condition"><i class="fa fa-check"></i><b>1.1.1</b> How to Form a Test Condition?</a></li>
<li class="chapter" data-level="1.1.2" data-path="decision-tree-in-hunts-algorithm.html"><a href="decision-tree-in-hunts-algorithm.html#best_split"><i class="fa fa-check"></i><b>1.1.2</b> How to Determine the Best Split Condition?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="the-simplest-decision-tree-for-titanic.html"><a href="the-simplest-decision-tree-for-titanic.html"><i class="fa fa-check"></i><b>1.2</b> The Simplest Decision Tree for Titanic</a></li>
<li class="chapter" data-level="1.3" data-path="the-decision-tree-with-core-predictors.html"><a href="the-decision-tree-with-core-predictors.html"><i class="fa fa-check"></i><b>1.3</b> The Decision Tree with Core Predictors</a></li>
<li class="chapter" data-level="1.4" data-path="the-decision-tree-with-more-predictors.html"><a href="the-decision-tree-with-more-predictors.html"><i class="fa fa-check"></i><b>1.4</b> The Decision Tree with More Predictors</a></li>
<li class="chapter" data-level="1.5" data-path="the-decision-tree-with-full-predictors.html"><a href="the-decision-tree-with-full-predictors.html"><i class="fa fa-check"></i><b>1.5</b> The Decision Tree with Full Predictors</a></li>
<li class="chapter" data-level="1.6" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>1.6</b> Summary</a></li>
<li class="chapter" data-level="1.7" data-path="excerces.html"><a href="excerces.html"><i class="fa fa-check"></i><b>1.7</b> Excerces</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-decision-tree-with-full-predictors" class="section level2">
<h2><span class="header-section-number">1.5</span> The Decision Tree with Full Predictors</h2>
<p>Let us use all the attributes:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="the-decision-tree-with-full-predictors.html#cb37-1"></a><span class="co"># The full-house classifier apart from name and ticket</span></span>
<span id="cb37-2"><a href="the-decision-tree-with-full-predictors.html#cb37-2"></a>model4 &lt;-<span class="st"> </span><span class="kw">rpart</span>(Survived <span class="op">~</span><span class="st"> </span>.,</span>
<span id="cb37-3"><a href="the-decision-tree-with-full-predictors.html#cb37-3"></a>              <span class="dt">data=</span>train,</span>
<span id="cb37-4"><a href="the-decision-tree-with-full-predictors.html#cb37-4"></a>              <span class="dt">method=</span><span class="st">&quot;class&quot;</span>)</span>
<span id="cb37-5"><a href="the-decision-tree-with-full-predictors.html#cb37-5"></a><span class="co">#assess prediction accuracy on train data</span></span>
<span id="cb37-6"><a href="the-decision-tree-with-full-predictors.html#cb37-6"></a>Predict_model4_train &lt;-<span class="st"> </span><span class="kw">predict</span>(model4, train, <span class="dt">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb37-7"><a href="the-decision-tree-with-full-predictors.html#cb37-7"></a>conMat &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(<span class="kw">as.factor</span>(Predict_model4_train), <span class="kw">as.factor</span>(train<span class="op">$</span>Survived))</span>
<span id="cb37-8"><a href="the-decision-tree-with-full-predictors.html#cb37-8"></a>conMat<span class="op">$</span>table</span></code></pre></div>
<pre><code>##           Reference
## Prediction   0   1
##          0 546   9
##          1   3 333</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="the-decision-tree-with-full-predictors.html#cb39-1"></a><span class="co">#conMat$overall</span></span>
<span id="cb39-2"><a href="the-decision-tree-with-full-predictors.html#cb39-2"></a>predict4_train_accuracy &lt;-<span class="st"> </span>conMat<span class="op">$</span>overall[<span class="st">&quot;Accuracy&quot;</span>]</span>
<span id="cb39-3"><a href="the-decision-tree-with-full-predictors.html#cb39-3"></a>predict4_train_accuracy</span></code></pre></div>
<pre><code>## Accuracy 
##   0.9865</code></pre>
<p>Our assessment on model4’s accuracy on the train data shows model4’s accuracy is 99%. This is hug improvement! Let us use this model to make a prediction on the test dataset.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="the-decision-tree-with-full-predictors.html#cb41-1"></a><span class="co"># make prediction on test dataset</span></span>
<span id="cb41-2"><a href="the-decision-tree-with-full-predictors.html#cb41-2"></a>Prediction4 &lt;-<span class="st"> </span><span class="kw">predict</span>(model4, test, <span class="dt">type =</span> <span class="st">&quot;class&quot;</span>)</span>
<span id="cb41-3"><a href="the-decision-tree-with-full-predictors.html#cb41-3"></a>submit4 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">PassengerId =</span> test<span class="op">$</span>PassengerId, <span class="dt">Survived =</span> Prediction4)</span>
<span id="cb41-4"><a href="the-decision-tree-with-full-predictors.html#cb41-4"></a><span class="kw">write.csv</span>(submit4, <span class="dt">file =</span> <span class="st">&quot;Tree_model4.CSV&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>We have produced a new prediction with new model. You can submit to Kaggle for an evaluation. You may find it has a pretty bed score (<strong>0.73684</strong>)! It even worse than the decision tree with only looking in to sex!!! Let us examine our classifier again by plot it in a graph.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="the-decision-tree-with-full-predictors.html#cb42-1"></a><span class="co"># plot our full house classifier </span></span>
<span id="cb42-2"><a href="the-decision-tree-with-full-predictors.html#cb42-2"></a><span class="kw">prp</span>(model4, <span class="dt">type =</span> <span class="dv">0</span>, <span class="dt">extra =</span> <span class="dv">1</span>, <span class="dt">under =</span> <span class="ot">TRUE</span>)</span>
<span id="cb42-3"><a href="the-decision-tree-with-full-predictors.html#cb42-3"></a><span class="kw">fancyRpartPlot</span>(model4)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:tree3"></span>
<img src="07-decision-tree_files/figure-html/tree3-1.svg" alt="Decision trees." width="50%" /><img src="07-decision-tree_files/figure-html/tree3-2.svg" alt="Decision trees." width="50%" />
<p class="caption">
Figure 1.8: Decision trees.
</p>
</div>
<p>We can see from the tree, the first test condition is <code>"title = Mr"</code>. We know that there are large number of passengers are male adult and most of them are perished. However, we can see from our decision tree (left branch) that there are two further test conditions are “Ticket_class” and “Deck” numbers. Our tree end with 2 survived leafs and one dead leaf. The purity on the leafs are not very high, the highest is 39:366 (90%:10%) and the lowest is 1:2 (33%:67%).</p>
<p>On the right hand side of the tree, although some leaves has higher purity but the overall percentage is very low. T he most powerful predictor Sex and pclass has been used towards the leaf of the tree. That could be an explanation of the poor performance. We will demonstrate the detailed interpretation of the model in the later chapter of cross validation and report.</p>
<p>Let us look into the difference between the last two predictions,</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="the-decision-tree-with-full-predictors.html#cb43-1"></a><span class="co"># build a comparison data frame to record each prediction results</span></span>
<span id="cb43-2"><a href="the-decision-tree-with-full-predictors.html#cb43-2"></a>compare &lt;-<span class="st"> </span><span class="kw">data.frame</span>(test<span class="op">$</span>PassengerId, <span class="dt">predict3 =</span> Prediction3 , <span class="dt">predict4 =</span> Prediction4)</span>
<span id="cb43-3"><a href="the-decision-tree-with-full-predictors.html#cb43-3"></a><span class="co"># Find differences</span></span>
<span id="cb43-4"><a href="the-decision-tree-with-full-predictors.html#cb43-4"></a>dif2 &lt;-<span class="st"> </span>compare[compare[<span class="dv">2</span>] <span class="op">!=</span><span class="st"> </span>compare[<span class="dv">3</span>], ]</span>
<span id="cb43-5"><a href="the-decision-tree-with-full-predictors.html#cb43-5"></a><span class="co">#show dif</span></span>
<span id="cb43-6"><a href="the-decision-tree-with-full-predictors.html#cb43-6"></a>dif2</span></code></pre></div>
<pre><code>##      test.PassengerId predict3 predict4
## 899               899        0        1
## 906               906        1        0
## 907               907        1        0
## 912               912        0        1
## 918               918        1        0
## 922               922        0        1
## 925               925        1        0
## 928               928        0        1
## 929               929        0        1
## 932               932        0        1
## 950               950        0        1
## 966               966        1        0
## 972               972        1        0
## 979               979        0        1
## 984               984        1        0
## 993               993        0        1
## 1006             1006        1        0
## 1011             1011        1        0
## 1023             1023        0        1
## 1030             1030        0        1
## 1034             1034        0        1
## 1046             1046        0        1
## 1048             1048        1        0
## 1056             1056        0        1
## 1061             1061        0        1
## 1073             1073        0        1
## 1074             1074        1        0
## 1082             1082        0        1
## 1084             1084        1        0
## 1091             1091        0        1
## 1092             1092        1        0
## 1093             1093        1        0
## 1106             1106        0        1
## 1109             1109        0        1
## 1110             1110        1        0
## 1122             1122        0        1
## 1126             1126        0        1
## 1128             1128        0        1
## 1134             1134        0        1
## 1136             1136        1        0
## 1137             1137        0        1
## 1139             1139        0        1
## 1140             1140        1        0
## 1152             1152        0        1
## 1160             1160        0        1
## 1165             1165        1        0
## 1167             1167        1        0
## 1169             1169        0        1
## 1172             1172        0        1
## 1176             1176        1        0
## 1185             1185        0        1
## 1200             1200        0        1
## 1201             1201        1        0
## 1208             1208        0        1
## 1219             1219        0        1
## 1220             1220        0        1
## 1236             1236        1        0
## 1245             1245        0        1
## 1251             1251        1        0
## 1268             1268        0        1
## 1271             1271        0        1
## 1274             1274        1        0
## 1282             1282        0        1
## 1286             1286        0        1
## 1306             1306        1        0</code></pre>
<p>There are 65 different predictions in comparison with the third prediction model3 that is the best model we have with the decision tree.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-decision-tree-with-more-predictors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown/edit/master/inst/examples/%s",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "none"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
